import 'package:flutter/foundation.dart';
import 'models/chapter_info.dart';
import 'models/theory_info.dart';
import 'models/theory_session.dart';

/// 교육 기능 Mock Repository
/// UI 개발 및 테스트용 더미 데이터 제공
class EducationMockRepository {
  /// 더미 챕터 목록 조회
  ///
  /// 사용자별 챕터 진행 상황과 함께 더미 데이터 반환
  Future<List<ChapterInfo>> getChaptersForUser() async {
    // 네트워크 지연 시뮬레이션
    await Future.delayed(const Duration(milliseconds: 500));

    return [
      const ChapterInfo(
        id: 1,
        title: '주식 기초 이론',
        isTheoryCompleted: true, // 이론 완료, 퀴즈 미완료
        isQuizCompleted: false,
      ),
      const ChapterInfo(
        id: 2,
        title: '기술적 분석 입문',
        isTheoryCompleted: false, // 이론, 퀴즈 모두 미완료
        isQuizCompleted: false,
      ),
      const ChapterInfo(
        id: 3,
        title: '재무제표 분석',
        isTheoryCompleted: true, // 이론, 퀴즈 모두 완료
        isQuizCompleted: true,
      ),
      const ChapterInfo(
        id: 4,
        title: '포트폴리오 관리',
        isTheoryCompleted: false, // 이론, 퀴즈 모두 미완료
        isQuizCompleted: false,
      ),
    ];
    // 예상 진행률: (이론 2개 + 퀴즈 1개) / (4 챕터 × 2) = 3/8 = 37.5%
  }

  /// 더미 이론 세션 시작
  ///
  /// 특정 챕터의 이론 학습 세션 시작 시뮬레이션
  Future<TheorySession> enterTheory(int chapterId) async {
    await Future.delayed(const Duration(milliseconds: 300));

    // 챕터별 더미 이론 데이터
    final theories = _getTheoriesForChapter(chapterId);

    return TheorySession(
      chapterId: chapterId,
      chapterTitle: '챕터 $chapterId',
      theories: theories,
      currentTheoryIndex: 0,
    );
  }

  /// 더미 이론 진도 업데이트
  ///
  /// 이론 학습 진도 업데이트 시뮬레이션
  Future<void> updateTheoryProgress(
    int chapterId,
    int theoryIndex,
    double progressPercentage,
  ) async {
    await Future.delayed(const Duration(milliseconds: 200));

    debugPrint(
      'Mock: 이론 진도 업데이트 - 챕터: $chapterId, 이론: $theoryIndex, 진도: $progressPercentage%',
    );
  }

  /// 더미 이론 완료
  ///
  /// 특정 이론 완료 처리 시뮬레이션
  /// 실제로는 서버에서 상태를 업데이트해야 하지만, Mock에서는 로그만 출력
  Future<void> completeTheory(int chapterId) async {
    await Future.delayed(const Duration(milliseconds: 300));

    debugPrint('Mock: 이론 완료 - 챕터: $chapterId');
    debugPrint('Mock: 실제 구현에서는 서버에서 상태를 업데이트하고 진행률을 재계산해야 함');
  }

  /// 챕터별 더미 이론 데이터 생성
  List<TheoryInfo> _getTheoriesForChapter(int chapterId) {
    switch (chapterId) {
      case 1:
        return [
          const TheoryInfo(
            id: 1,
            word: '주식이란 무엇인가?',
            content: '''
# 주식의 기본 개념

주식(Stock)은 기업의 소유권을 나타내는 증권입니다. 주식을 보유한다는 것은 해당 기업의 일부를 소유한다는 의미입니다.

## 주요 특징

### 1. 소유권
- 주주는 기업의 소유자 중 한 명
- 의결권을 통해 기업 경영에 참여 가능
- 배당금 수령 권리

### 2. 수익성
- **자본 이득**: 주가 상승으로 인한 수익
- **배당 수익**: 기업이 지급하는 배당금

### 3. 위험성
- 주가 변동에 따른 손실 가능성
- 기업 파산 시 투자금 손실 위험

주식 투자를 시작하기 전에 충분한 학습과 준비가 필요합니다.
            ''',
          ),
          const TheoryInfo(
            id: 2,
            word: '주식 시장의 구조',
            content: '''
# 주식 시장의 구조

주식 시장은 주식의 발행과 거래가 이루어지는 시장입니다.

## 시장의 분류

### 1. 발행 시장 (Primary Market)
- 기업이 새로운 주식을 발행하는 시장
- IPO(Initial Public Offering) 진행
- 자금 조달 목적

### 2. 유통 시장 (Secondary Market)
- 이미 발행된 주식이 거래되는 시장
- 투자자 간 매매 거래
- 가격 발견 기능

시장의 구조를 이해하면 더 효과적인 투자가 가능합니다.
            ''',
          ),
          const TheoryInfo(
            id: 3,
            word: '주식 투자 용어',
            content: '''
# 주식 투자 필수 용어

주식 투자를 위해 반드시 알아야 할 기본 용어들을 정리했습니다.

## 기본 용어

### 주가 관련
- **시가**: 장 시작 시 첫 거래 가격
- **고가**: 하루 중 가장 높은 가격
- **저가**: 하루 중 가장 낮은 가격
- **종가**: 장 마감 시 마지막 거래 가격

### 거래량 관련
- **거래량**: 특정 기간 동안 거래된 주식 수
- **거래대금**: 거래량 × 주가의 총합

용어를 정확히 이해하고 사용하는 것이 성공적인 투자의 첫걸음입니다.
            ''',
          ),
          const TheoryInfo(
            id: 4,
            word: '주식 투자의 위험과 수익',
            content: '''
# 주식 투자의 위험과 수익

모든 투자에는 위험이 따르며, 주식 투자도 예외가 아닙니다.

## 투자 위험의 종류

### 1. 시장 위험 (Market Risk)
- 전체 시장의 하락으로 인한 손실
- 경제 상황, 정치적 불안정 등이 원인

### 2. 개별 기업 위험 (Company Risk)
- 특정 기업의 실적 악화
- 경영진 교체, 스캔들 등

### 3. 유동성 위험 (Liquidity Risk)
- 원하는 시점에 매도하기 어려운 상황
- 거래량이 적은 종목에서 주로 발생

## 위험 관리 방법
- 분산 투자
- 손절매 설정
- 정기적인 포트폴리오 점검
            ''',
          ),
          const TheoryInfo(
            id: 5,
            word: '주식 투자 시작하기',
            content: '''
# 주식 투자 시작하기

이제 실제로 주식 투자를 시작해보겠습니다.

## 투자 준비 단계

### 1. 투자 목표 설정
- 투자 기간 결정 (단기/중기/장기)
- 목표 수익률 설정
- 위험 허용 수준 파악

### 2. 투자 자금 준비
- 여유 자금으로만 투자
- 생활비와 비상금은 별도 보관
- 투자 금액의 한계 설정

### 3. 증권사 선택
- 수수료 비교
- 투자 도구 및 정보 제공 수준
- 고객 서비스 품질

### 4. 첫 투자 종목 선택
- 대형주부터 시작 권장
- 본인이 이해하는 업종 선택
- 충분한 조사 후 투자 결정

차근차근 준비하여 성공적인 투자를 시작하세요!
            ''',
          ),
        ];
      case 2:
        return [
          const TheoryInfo(
            id: 6,
            word: '차트의 기본 이해',
            content: '''
# 차트의 기본 이해

기술적 분석의 첫걸음은 차트를 올바르게 읽는 것입니다.

## 차트의 종류

### 1. 선 차트 (Line Chart)
- 종가만을 연결한 단순한 차트
- 전체적인 추세 파악에 유용

### 2. 캔들스틱 차트 (Candlestick Chart)
- 일본에서 개발된 차트 방식
- 시각적으로 직관적
- 가장 널리 사용됨

### 3. 바 차트 (Bar Chart)
- 시가, 고가, 저가, 종가를 모두 표시
- 서양에서 전통적으로 사용

차트 분석은 과거 데이터를 바탕으로 하므로, 다른 지표와 함께 종합적으로 판단해야 합니다.
            ''',
          ),
          const TheoryInfo(
            id: 7,
            word: '캔들스틱 패턴',
            content: '''
# 캔들스틱 패턴

캔들스틱 차트에서 나타나는 다양한 패턴을 통해 주가의 향후 방향을 예측할 수 있습니다.

## 기본 캔들 구조

### 양봉 (상승 캔들)
- 종가가 시가보다 높은 경우
- 일반적으로 흰색 또는 초록색으로 표시

### 음봉 (하락 캔들)
- 종가가 시가보다 낮은 경우
- 일반적으로 검은색 또는 빨간색으로 표시

## 주요 반전 패턴

### 1. 도지 (Doji)
- 시가와 종가가 거의 같은 경우
- 시장의 우유부단함을 나타냄

### 2. 해머 (Hammer)
- 하락 추세 끝에서 나타나는 상승 신호
- 긴 아래꼬리와 작은 몸통이 특징

### 3. 슈팅스타 (Shooting Star)
- 상승 추세 끝에서 나타나는 하락 신호
- 긴 위꼬리와 작은 몸통이 특징
            ''',
          ),
          const TheoryInfo(
            id: 8,
            word: '이동평균선',
            content: '''
# 이동평균선 (Moving Average)

이동평균선은 가장 기본적이면서도 중요한 기술적 지표입니다.

## 이동평균선의 종류

### 1. 단순이동평균 (SMA)
- 일정 기간의 종가를 단순 평균
- 가장 기본적인 형태

### 2. 지수이동평균 (EMA)
- 최근 가격에 더 큰 가중치 부여
- 단순이동평균보다 민감하게 반응

### 3. 가중이동평균 (WMA)
- 각 기간에 다른 가중치 적용
- 최근 데이터에 더 높은 비중

## 주요 활용법

### 추세 확인
- 주가가 이동평균선 위에 있으면 상승 추세
- 주가가 이동평균선 아래에 있으면 하락 추세

### 매매 신호
- 골든크로스: 단기 이평선이 장기 이평선을 상향 돌파
- 데드크로스: 단기 이평선이 장기 이평선을 하향 돌파

### 지지와 저항
- 상승 추세에서 이동평균선은 지지선 역할
- 하락 추세에서 이동평균선은 저항선 역할
            ''',
          ),
          const TheoryInfo(
            id: 9,
            word: 'RSI와 스토캐스틱',
            content: '''
# RSI와 스토캐스틱

과매수/과매도 상태를 판단하는 대표적인 보조지표들입니다.

## RSI (Relative Strength Index)

### 개념
- 상대강도지수
- 0~100 사이의 값으로 표시
- 일반적으로 14일 기준 사용

### 해석
- 70 이상: 과매수 구간 (매도 신호)
- 30 이하: 과매도 구간 (매수 신호)
- 50: 중립 구간

### 다이버전스
- 주가는 상승하지만 RSI는 하락 → 약세 다이버전스
- 주가는 하락하지만 RSI는 상승 → 강세 다이버전스

## 스토캐스틱 (Stochastic)

### 개념
- 일정 기간 중 현재 가격의 상대적 위치
- %K와 %D 두 개의 선으로 구성

### 해석
- 80 이상: 과매수 구간
- 20 이하: 과매도 구간
- %K가 %D를 상향 돌파: 매수 신호
- %K가 %D를 하향 돌파: 매도 신호

두 지표 모두 단독 사용보다는 다른 지표와 함께 사용할 때 더욱 효과적입니다.
            ''',
          ),
          const TheoryInfo(
            id: 10,
            word: '볼린저 밴드와 MACD',
            content: '''
# 볼린저 밴드와 MACD

추세와 변동성을 동시에 분석할 수 있는 고급 기술적 지표들입니다.

## 볼린저 밴드 (Bollinger Bands)

### 구성 요소
- 중심선: 20일 이동평균선
- 상단밴드: 중심선 + (2 × 표준편차)
- 하단밴드: 중심선 - (2 × 표준편차)

### 활용법
- 밴드 수축: 변동성 감소, 큰 움직임 예고
- 밴드 확장: 변동성 증가, 추세 강화
- 상단밴드 터치: 과매수 신호
- 하단밴드 터치: 과매도 신호

## MACD (Moving Average Convergence Divergence)

### 구성 요소
- MACD선: 12일 EMA - 26일 EMA
- 신호선: MACD선의 9일 EMA
- 히스토그램: MACD선 - 신호선

### 매매 신호
- MACD선이 신호선을 상향 돌파: 매수 신호
- MACD선이 신호선을 하향 돌파: 매도 신호
- 히스토그램이 0선 위로: 상승 모멘텀
- 히스토그램이 0선 아래로: 하락 모멘텀

### 다이버전스 분석
- 주가 신고점 vs MACD 신고점 비교
- 추세 전환의 조기 신호 포착 가능
            ''',
          ),
        ];
      case 3:
        return [
          const TheoryInfo(
            id: 11,
            word: '기업 분석의 기초',
            content: '''
# 기업 분석의 기초

성공적인 주식 투자를 위해서는 기업에 대한 깊이 있는 분석이 필요합니다.

## 기업 분석의 종류

### 1. 정성적 분석 (Qualitative Analysis)
- 경영진의 능력과 비전
- 사업 모델의 지속가능성
- 시장에서의 경쟁력
- 브랜드 가치와 고객 충성도

### 2. 정량적 분석 (Quantitative Analysis)
- 재무제표 분석
- 각종 재무비율 계산
- 성장성 지표 검토
- 수익성 지표 분석

## 분석 시 고려사항

### 산업 특성 이해
- 업종별 특성과 사이클
- 규제 환경과 정책 변화
- 기술 발전과 트렌드 변화

### 경쟁사 비교
- 동종업계 내 위치
- 시장점유율과 경쟁우위
- 상대적 밸류에이션

체계적인 기업 분석을 통해 투자 위험을 줄이고 수익률을 높일 수 있습니다.
            ''',
          ),
          const TheoryInfo(
            id: 12,
            word: '재무제표 읽기',
            content: '''
# 재무제표 읽기

재무제표는 기업의 재무 상태와 경영 성과를 나타내는 핵심 자료입니다.

## 3대 재무제표

### 1. 재무상태표 (Balance Sheet)
- 자산, 부채, 자본의 구성
- 특정 시점의 재무 상태 표시
- 기업의 안정성 평가 가능

#### 주요 항목
- **유동자산**: 1년 내 현금화 가능한 자산
- **고정자산**: 장기간 보유하는 자산
- **유동부채**: 1년 내 상환해야 할 부채
- **장기부채**: 1년 후 상환하는 부채

### 2. 손익계산서 (Income Statement)
- 일정 기간의 수익과 비용
- 기업의 수익성 평가
- 영업활동의 효율성 측정

#### 주요 항목
- **매출액**: 기업의 총 수입
- **영업이익**: 본업에서 발생한 이익
- **당기순이익**: 최종적으로 남은 이익

### 3. 현금흐름표 (Cash Flow Statement)
- 현금의 유입과 유출
- 실제 현금 창출 능력 평가
- 영업, 투자, 재무활동으로 구분
            ''',
          ),
          const TheoryInfo(
            id: 13,
            word: '주요 재무비율',
            content: '''
# 주요 재무비율

재무비율을 통해 기업의 재무 건전성과 수익성을 객관적으로 평가할 수 있습니다.

## 수익성 비율

### 1. ROE (자기자본이익률)
- 공식: 당기순이익 ÷ 자기자본 × 100
- 주주 투자 대비 수익률
- 높을수록 좋음 (일반적으로 10% 이상)

### 2. ROA (총자산이익률)
- 공식: 당기순이익 ÷ 총자산 × 100
- 자산 활용 효율성
- 업종별 평균과 비교 필요

### 3. 영업이익률
- 공식: 영업이익 ÷ 매출액 × 100
- 본업의 수익성 측정
- 지속적인 증가 추세가 바람직

## 안정성 비율

### 1. 부채비율
- 공식: 총부채 ÷ 자기자본 × 100
- 재무 안정성 측정
- 낮을수록 안정적 (200% 이하 권장)

### 2. 유동비율
- 공식: 유동자산 ÷ 유동부채 × 100
- 단기 지급능력 평가
- 150% 이상이 안전

### 3. 당좌비율
- 공식: 당좌자산 ÷ 유동부채 × 100
- 즉시 현금화 가능한 자산 비율
- 100% 이상이 바람직
            ''',
          ),
          const TheoryInfo(
            id: 14,
            word: '밸류에이션 지표',
            content: '''
# 밸류에이션 지표

주식의 적정 가치를 평가하는 핵심 지표들입니다.

## 주가 관련 지표

### 1. PER (주가수익비율)
- 공식: 주가 ÷ 주당순이익
- 주가가 1주당 순이익의 몇 배인지 표시
- 낮을수록 저평가 (업종 평균과 비교)

### 2. PBR (주가순자산비율)
- 공식: 주가 ÷ 주당순자산
- 청산가치 대비 주가 수준
- 1배 미만이면 저평가 가능성

### 3. PSR (주가매출비율)
- 공식: 주가 ÷ 주당매출액
- 매출 대비 주가 수준
- 적자 기업 평가 시 유용

## 배당 관련 지표

### 1. 배당수익률
- 공식: 주당배당금 ÷ 주가 × 100
- 배당 투자자에게 중요한 지표
- 높을수록 좋지만 지속가능성 고려

### 2. 배당성향
- 공식: 주당배당금 ÷ 주당순이익 × 100
- 순이익 중 배당으로 지급하는 비율
- 적정 수준은 30-50%

## 성장성 지표

### 1. 매출액 증가율
- 전년 대비 매출 성장률
- 지속적인 성장세가 중요

### 2. 순이익 증가율
- 전년 대비 순이익 성장률
- 수익성 개선 여부 확인
            ''',
          ),
        ];
      case 4:
        return [
          const TheoryInfo(
            id: 15,
            word: '투자 전략의 종류',
            content: '''
# 투자 전략의 종류

다양한 투자 전략을 이해하고 자신에게 맞는 방법을 선택하는 것이 중요합니다.

## 투자 기간별 분류

### 1. 장기 투자 (Long-term Investment)
- 투자 기간: 3년 이상
- 기업의 내재 가치에 집중
- 복리 효과 극대화
- 시장 변동성에 덜 민감

### 2. 중기 투자 (Medium-term Investment)
- 투자 기간: 6개월 ~ 3년
- 경기 사이클과 업종 순환 활용
- 기술적 분석과 기본적 분석 병행

### 3. 단기 투자 (Short-term Investment)
- 투자 기간: 1일 ~ 6개월
- 기술적 분석 중심
- 높은 위험과 높은 수익 가능성
- 전문적 지식과 경험 필요

## 투자 스타일별 분류

### 1. 가치 투자 (Value Investing)
- 저평가된 우량주 발굴
- PER, PBR 등 밸류에이션 지표 중시
- 워렌 버핏의 대표적 투자 방식

### 2. 성장 투자 (Growth Investing)
- 높은 성장 잠재력을 가진 기업
- 매출, 이익 증가율 중시
- 상대적으로 높은 밸류에이션 감수

### 3. 배당 투자 (Dividend Investing)
- 안정적인 배당 수익 추구
- 배당수익률과 배당 안정성 중시
- 보수적 투자자에게 적합
            ''',
          ),
          const TheoryInfo(
            id: 16,
            word: '포트폴리오 구성',
            content: '''
# 포트폴리오 구성

효과적인 포트폴리오 구성을 통해 위험을 분산하고 안정적인 수익을 추구할 수 있습니다.

## 분산투자의 원칙

### 1. 종목 분산
- 10-20개 종목으로 분산
- 한 종목 비중 5-10% 이하 권장
- 상관관계가 낮은 종목 선택

### 2. 업종 분산
- 다양한 산업군에 투자
- 경기 민감주와 방어주 균형
- 신성장 동력과 전통 산업 조화

### 3. 시간 분산
- 분할 매수를 통한 평균 단가 낮추기
- 정기적인 투자 (달러 코스트 애버리징)
- 시장 타이밍 리스크 감소

## 자산 배분 전략

### 1. 연령별 자산 배분
- 젊은 층: 주식 70-80%, 채권 20-30%
- 중년층: 주식 50-60%, 채권 40-50%
- 고령층: 주식 30-40%, 채권 60-70%

### 2. 위험 성향별 배분
- 공격적: 성장주 중심, 높은 변동성 감수
- 중립적: 가치주와 성장주 균형
- 보수적: 배당주와 우량주 중심

## 리밸런싱

### 정기적 점검
- 분기별 또는 반기별 포트폴리오 점검
- 목표 비중과 현재 비중 비교
- 필요시 매매를 통한 비중 조정

### 리밸런싱 시점
- 목표 비중에서 ±5% 이상 벗어날 때
- 시장 상황 변화 시
- 개인 투자 목표 변경 시
            ''',
          ),
          const TheoryInfo(
            id: 17,
            word: '위험 관리',
            content: '''
# 위험 관리

성공적인 투자를 위해서는 수익 추구만큼 위험 관리가 중요합니다.

## 손실 관리 방법

### 1. 손절매 (Stop Loss)
- 미리 정한 손실 한도에서 매도
- 일반적으로 매수가 대비 -10~20%
- 감정적 판단 배제, 기계적 실행

### 2. 분할 매수/매도
- 한 번에 전량 거래하지 않기
- 시장 변동성에 대응
- 평균 단가 개선 효과

### 3. 포지션 사이징
- 개별 종목 투자 비중 제한
- 위험 자산과 안전 자산 균형
- 투자 가능 자금의 일정 비율만 투자

## 심리적 위험 관리

### 1. 감정 통제
- 탐욕과 공포 극복
- 객관적 데이터 기반 판단
- 투자 일지 작성 습관

### 2. 확증 편향 주의
- 자신의 판단을 뒷받침하는 정보만 찾는 경향
- 반대 의견도 적극적으로 검토
- 다양한 관점에서 분석

### 3. 군중 심리 극복
- 시장 분위기에 휩쓸리지 않기
- 독립적 사고와 판단
- 역발상 투자 고려

## 시장 위험 대응

### 1. 경기 사이클 이해
- 경기 확장기와 수축기 특성
- 업종별 사이클 차이 인식
- 방어적 포트폴리오 구성

### 2. 거시경제 지표 모니터링
- 금리, 환율, 유가 등 주요 지표
- 정부 정책과 규제 변화
- 글로벌 경제 동향
            ''',
          ),
        ];
      default:
        return [
          TheoryInfo(
            id: 100 + chapterId,
            word: '챕터 $chapterId 기본 이론',
            content: '''
# 챕터 $chapterId 기본 이론

이것은 챕터 $chapterId의 기본 이론 내용입니다.

## 학습 목표
- 기본 개념 이해
- 실무 적용 방법 학습
- 투자 전략 수립

더 자세한 내용은 실제 서비스에서 제공됩니다.
            ''',
          ),
        ];
    }
  }
}
