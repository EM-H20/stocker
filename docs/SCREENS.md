# Stocker 화면 흐름도

> 앱의 모든 화면과 네비게이션 흐름을 정리한 문서

---

## 1. 전체 화면 구조

### 1.1 화면 목록
| 번호 | 화면명 | 경로 | 설명 |
|------|--------|------|------|
| 1 | 로그인 | `/login` | 사용자 로그인 |
| 2 | 회원가입 | `/register` | 신규 회원가입 |
| 3 | 교육 (탭) | `/education` | 챕터 목록 및 학습 |
| 4 | 출석 (탭) | `/attendance` | 출석 캘린더 |
| 5 | 오답노트 (탭) | `/wrong-note` | 틀린 문제 복습 |
| 6 | 마이페이지 (탭) | `/mypage` | 프로필 및 설정 |
| 7 | 이론 학습 | `/theory?chapterId=` | 이론 콘텐츠 학습 |
| 8 | 퀴즈 | `/quiz?chapterId=` | 퀴즈 풀기 |
| 9 | 퀴즈 결과 | `/quiz-result?chapterId=` | 퀴즈 결과 확인 |
| 10 | 성향 분석 메인 | `/aptitude` | 성향 분석 시작 |
| 11 | 성향 분석 퀴즈 | `/aptitude/quiz` | 성향 테스트 |
| 12 | 성향 분석 결과 | `/aptitude/result` | 결과 및 추천 |
| 13 | 성향 유형 목록 | `/aptitude/types` | 모든 유형 보기 |
| 14 | 노트 목록 | `/notes` | 작성한 노트 |
| 15 | 노트 에디터 | `/notes/editor` | 노트 작성/편집 |

---

## 2. 화면 흐름도

### 2.1 전체 네비게이션 맵
```
                            ┌─────────────┐
                            │   앱 시작   │
                            └──────┬──────┘
                                   │
                         ┌─────────┴─────────┐
                         │   인증 상태 확인   │
                         └─────────┬─────────┘
                                   │
               ┌───────────────────┼───────────────────┐
               │                   │                   │
         [비로그인]          [토큰 만료]          [로그인됨]
               │                   │                   │
               ▼                   ▼                   ▼
        ┌──────────┐        ┌──────────┐        ┌──────────┐
        │  로그인  │        │토큰 갱신 │        │ 메인 탭  │
        └────┬─────┘        └────┬─────┘        └────┬─────┘
             │                   │                   │
      ┌──────┴──────┐            │                   │
      │             │            │                   │
┌──────────┐ ┌──────────┐        │                   │
│회원가입  │ │ 로그인   │        │                   │
│          │ │ 성공    │        │                   │
└────┬─────┘ └────┬─────┘        │                   │
     │            │              │                   │
     └────────────┴──────────────┴───────────────────┘
                                 │
                                 ▼
                    ┌────────────────────────┐
                    │      HomeShell         │
                    │  (BottomNavigation)    │
                    └────────────┬───────────┘
                                 │
          ┌──────────┬───────────┼───────────┬──────────┐
          │          │           │           │          │
          ▼          ▼           ▼           ▼          ▼
     ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐
     │  교육  │ │  출석  │ │오답노트│ │마이페이지│ │  기타  │
     │  탭   │ │  탭   │ │  탭   │ │  탭   │ │  화면  │
     └───┬────┘ └───┬────┘ └───┬────┘ └───┬────┘ └───┬────┘
         │          │          │          │          │
         ▼          ▼          ▼          ▼          ▼
    [교육 흐름] [출석 흐름] [오답 흐름] [마이 흐름] [부가 화면]
```

---

### 2.2 인증 흐름
```
┌──────────────────────────────────────────────────────────┐
│                      인증 화면 흐름                       │
└──────────────────────────────────────────────────────────┘

    ┌──────────────┐
    │   로그인     │
    │   화면      │
    └──────┬───────┘
           │
    ┌──────┴───────────────────────────┐
    │                                  │
    ▼                                  ▼
┌──────────────┐              ┌──────────────┐
│  회원가입    │              │  로그인      │
│  버튼 클릭   │              │  버튼 클릭   │
└──────┬───────┘              └──────┬───────┘
       │                             │
       ▼                             │
┌──────────────┐                     │
│  회원가입    │                     │
│    화면     │                     │
└──────┬───────┘                     │
       │                             │
       │ [가입 완료]                 │
       │                             │
       └─────────────┬───────────────┘
                     │
                     ▼
              ┌──────────────┐
              │   API 호출   │
              │  (인증 처리) │
              └──────┬───────┘
                     │
        ┌────────────┴────────────┐
        │                         │
   [실패]                    [성공]
        │                         │
        ▼                         ▼
┌──────────────┐          ┌──────────────┐
│ 에러 메시지  │          │ 토큰 저장    │
│   표시      │          │ → 메인 탭    │
└──────────────┘          └──────────────┘
```

---

### 2.3 교육 탭 흐름
```
┌──────────────────────────────────────────────────────────┐
│                      교육 화면 흐름                       │
└──────────────────────────────────────────────────────────┘

┌──────────────────┐
│   교육 화면      │
│ (EducationScreen)│
├──────────────────┤
│ ▪ 검색바        │
│ ▪ 진행률 표시   │
│ ▪ 챕터 카드 목록│
└────────┬─────────┘
         │
         │ [챕터 카드 클릭]
         │
         ├─────────────────────┐
         │                     │
         ▼                     ▼
┌──────────────────┐  ┌──────────────────┐
│   이론 학습      │  │   퀴즈 시작      │
│  버튼 클릭       │  │   버튼 클릭      │
└────────┬─────────┘  └────────┬─────────┘
         │                     │
         ▼                     ▼
┌──────────────────┐  ┌──────────────────┐
│   TheoryScreen   │  │   QuizScreen     │
│   (이론 화면)    │  │   (퀴즈 화면)    │
├──────────────────┤  ├──────────────────┤
│ ▪ PageView      │  │ ▪ 진행률 바      │
│ ▪ 이론 내용     │  │ ▪ 문제 카드      │
│ ▪ 페이지 표시   │  │ ▪ O/X 버튼       │
│ ▪ 네비게이션    │  │ ▪ 해설 표시      │
└────────┬─────────┘  └────────┬─────────┘
         │                     │
         │ [학습 완료]         │ [퀴즈 완료]
         │                     │
         ▼                     ▼
┌──────────────────┐  ┌──────────────────┐
│ 완료 상태 저장   │  │ QuizResultScreen │
│ → 교육 화면     │  │   (결과 화면)    │
└──────────────────┘  ├──────────────────┤
                      │ ▪ 점수 표시      │
                      │ ▪ 정답률 그래프  │
                      │ ▪ 문제별 결과    │
                      └────────┬─────────┘
                               │
                        ┌──────┴──────┐
                        │             │
                        ▼             ▼
                   [다시 풀기]   [오답노트 확인]
                        │             │
                        ▼             ▼
                   QuizScreen    WrongNoteScreen
```

---

### 2.4 출석 탭 흐름
```
┌──────────────────────────────────────────────────────────┐
│                      출석 화면 흐름                       │
└──────────────────────────────────────────────────────────┘

┌──────────────────┐
│   출석 화면      │
│(AttendanceScreen)│
├──────────────────┤
│ ▪ TableCalendar │
│ ▪ 출석 통계     │
│ ▪ 출석 버튼     │
└────────┬─────────┘
         │
         │ [출석 체크 클릭]
         │
         ▼
┌──────────────────┐
│   출석 가능?     │
│   (오늘 미출석)  │
└────────┬─────────┘
         │
    ┌────┴────┐
    │         │
   [NO]      [YES]
    │         │
    ▼         ▼
┌────────┐ ┌──────────────────┐
│ 이미   │ │  출석 퀴즈       │
│ 출석함 │ │  다이얼로그      │
│ 안내   │ ├──────────────────┤
└────────┘ │ ▪ O/X 문제 3개   │
           │ ▪ 제출 버튼      │
           └────────┬─────────┘
                    │
                    │ [퀴즈 제출]
                    │
                    ▼
           ┌──────────────────┐
           │   정답 확인      │
           │   출석 완료!     │
           └────────┬─────────┘
                    │
                    ▼
           ┌──────────────────┐
           │  캘린더 업데이트 │
           │  연속 출석 갱신  │
           └──────────────────┘
```

---

### 2.5 마이페이지 탭 흐름
```
┌──────────────────────────────────────────────────────────┐
│                    마이페이지 화면 흐름                    │
└──────────────────────────────────────────────────────────┘

┌──────────────────┐
│  마이페이지      │
│ (MypageScreen)   │
├──────────────────┤
│ ▪ 프로필 정보   │
│ ▪ 학습 통계     │
│ ▪ 메뉴 목록     │
│ ▪ 설정          │
└────────┬─────────┘
         │
    ┌────┴────────────┬───────────────┬───────────────┬────────────┐
    │                 │               │               │            │
    ▼                 ▼               ▼               ▼            ▼
┌────────┐     ┌────────────┐  ┌────────────┐  ┌────────┐   ┌────────┐
│성향분석│     │   노트     │  │  오답노트   │  │  설정  │   │로그아웃│
│메뉴    │     │   메뉴     │  │   메뉴     │  │        │   │        │
└───┬────┘     └─────┬──────┘  └─────┬──────┘  └───┬────┘   └───┬────┘
    │                │               │             │            │
    ▼                ▼               ▼             ▼            ▼
┌────────────┐ ┌────────────┐ ┌────────────┐ ┌────────┐  ┌────────┐
│ Aptitude   │ │NoteList    │ │WrongNote   │ │다크모드│  │토큰삭제│
│ Initial    │ │Screen      │ │Screen      │ │토글    │  │→로그인 │
│ Screen     │ │            │ │            │ │알림설정│  │        │
└─────┬──────┘ └─────┬──────┘ └────────────┘ └────────┘  └────────┘
      │              │
      ▼              ▼
[성향 분석 흐름]  [노트 흐름]
```

---

### 2.6 성향 분석 흐름
```
┌──────────────────────────────────────────────────────────┐
│                    성향 분석 화면 흐름                     │
└──────────────────────────────────────────────────────────┘

┌──────────────────┐
│  성향 분석 메인  │
│(AptitudeInitial) │
├──────────────────┤
│ ▪ 소개 텍스트   │
│ ▪ 시작 버튼     │
│ ▪ 유형 목록 링크│
└────────┬─────────┘
         │
    ┌────┴────────────────┐
    │                     │
    ▼                     ▼
┌──────────────┐   ┌──────────────────┐
│테스트 시작   │   │모든 유형 보기    │
│버튼 클릭     │   │링크 클릭         │
└──────┬───────┘   └────────┬─────────┘
       │                    │
       ▼                    ▼
┌──────────────────┐ ┌──────────────────┐
│  AptitudeQuiz    │ │ AptitudeTypes    │
│   Screen         │ │  ListScreen      │
├──────────────────┤ ├──────────────────┤
│ ▪ 진행률 (1/20) │ │ ▪ 5개 유형 카드 │
│ ▪ 질문 카드     │ │ ▪ 유형별 설명   │
│ ▪ 4~5개 선택지  │ │                  │
│ ▪ 이전/다음     │ │                  │
└────────┬─────────┘ └──────────────────┘
         │
         │ [20문항 완료]
         │
         ▼
┌──────────────────┐
│ 결과 계산 중...  │
│ (로딩 표시)      │
└────────┬─────────┘
         │
         ▼
┌──────────────────┐
│ AptitudeResult   │
│   Screen         │
├──────────────────┤
│ ▪ 투자 유형 표시│
│ ▪ 레이더 차트   │
│ ▪ 유형 설명     │
│ ▪ 포트폴리오 추천│
│ ▪ 파이 차트     │
│ ▪ 다시 테스트   │
└──────────────────┘
```

---

### 2.7 노트 흐름
```
┌──────────────────────────────────────────────────────────┐
│                      노트 화면 흐름                       │
└──────────────────────────────────────────────────────────┘

┌──────────────────┐
│   노트 목록      │
│ (NoteListScreen) │
├──────────────────┤
│ ▪ 검색바        │
│ ▪ 노트 카드 목록│
│ ▪ FAB (새 노트) │
└────────┬─────────┘
         │
    ┌────┴────────────────┐
    │                     │
    ▼                     ▼
┌──────────────┐   ┌──────────────────┐
│노트 카드 클릭│   │ FAB 클릭         │
│(기존 노트)   │   │ (새 노트 생성)   │
└──────┬───────┘   └────────┬─────────┘
       │                    │
       │                    ▼
       │           ┌──────────────────┐
       │           │ 템플릿 선택      │
       │           │ 다이얼로그       │
       │           ├──────────────────┤
       │           │ ▪ 빈 노트       │
       │           │ ▪ 학습 노트     │
       │           │ ▪ 투자 분석     │
       │           │ ▪ 거래 일지     │
       │           │ ▪ 독서 메모     │
       │           └────────┬─────────┘
       │                    │
       └────────────────────┘
                    │
                    ▼
         ┌──────────────────┐
         │ NoteEditorScreen │
         ├──────────────────┤
         │ ▪ 제목 입력     │
         │ ▪ QuillEditor   │
         │   - 볼드/이탤릭 │
         │   - 리스트      │
         │   - 체크박스    │
         │ ▪ 저장 버튼     │
         └────────┬─────────┘
                  │
             [저장 완료]
                  │
                  ▼
         ┌──────────────────┐
         │ 노트 목록으로    │
         │ 자동 복귀        │
         └──────────────────┘
```

---

## 3. 네비게이션 가이드

### 3.1 탭 네비게이션 (4개 탭)
```dart
// HomeShell에서 관리
enum TabItem {
  education,   // 교육 (0)
  attendance,  // 출석 (1)
  wrongNote,   // 오답노트 (2)
  mypage,      // 마이페이지 (3)
}
```

### 3.2 화면 이동 방법
```dart
// 탭 내 화면 이동 (push)
context.go(AppRoutes.theory, queryParams: {'chapterId': '1'});

// 모달/다이얼로그
showDialog(context: context, builder: (_) => AttendanceQuizDialog());

// 탭 전환
ref.read(homeNavigationProvider.notifier).setTab(TabItem.education);
```

### 3.3 라우트 상수
```dart
class AppRoutes {
  // 인증
  static const login = '/login';
  static const register = '/register';

  // 메인 탭
  static const education = '/education';
  static const attendance = '/attendance';
  static const wrongNote = '/wrong-note';
  static const mypage = '/mypage';

  // 서브 화면
  static const theory = '/theory';
  static const quiz = '/quiz';
  static const quizResult = '/quiz-result';
  static const aptitude = '/aptitude';
  static const aptitudeQuiz = '/aptitude/quiz';
  static const aptitudeResult = '/aptitude/result';
  static const aptitudeTypesList = '/aptitude/types';
  static const noteList = '/notes';
  static const noteEditor = '/notes/editor';
}
```

---

## 4. 화면 상태 관리

### 4.1 화면별 상태
| 화면 | Provider/Notifier | 상태 내용 |
|------|-------------------|----------|
| 로그인 | AuthNotifier | isLoading, errorMessage, user |
| 교육 | EducationNotifier | chapters, isLoading, error |
| 출석 | AttendanceNotifier | attendance, quizState |
| 퀴즈 | QuizNotifier | session, currentIndex, answers |
| 성향 | AptitudeNotifier | questions, result, progress |
| 노트 | NoteNotifier | notes, isLoading |

### 4.2 전역 상태
| Provider | 용도 |
|----------|------|
| themeModeProvider | 다크/라이트 테마 |
| homeNavigationProvider | 현재 선택된 탭 |
| authStateProvider | 로그인 상태 |

---

## 5. 화면 컴포넌트 구조

### 5.1 공통 레이아웃
```
┌─────────────────────────────────────┐
│            AppBar (선택적)           │
├─────────────────────────────────────┤
│                                     │
│                                     │
│            Body Content             │
│         (Scaffold body)             │
│                                     │
│                                     │
├─────────────────────────────────────┤
│      BottomNavigationBar            │
│   (HomeShell에서만 - 4개 탭 화면)   │
└─────────────────────────────────────┘
```

### 5.2 화면 템플릿
```dart
class SampleScreen extends ConsumerWidget {
  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final state = ref.watch(sampleNotifierProvider);

    return Scaffold(
      appBar: AppBar(title: Text('화면 제목')),
      body: state.isLoading
          ? LoadingWidget()
          : state.error != null
              ? ErrorWidget(message: state.error!)
              : _buildContent(state),
    );
  }
}
```

---

## 6. 접근성 고려사항

- **Tab 순서**: 논리적인 탭 순서로 키보드 네비게이션 지원
- **스크린 리더**: 모든 버튼과 이미지에 semantic label 제공
- **색상 대비**: WCAG 2.1 기준 4.5:1 대비율 준수
- **터치 영역**: 최소 48x48dp 터치 타겟 보장
- **폰트 크기**: 시스템 폰트 크기 설정 반영
